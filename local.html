<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="stylesheet" href="css/todol.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
        integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet"/> -->
</head>

<body>
    <div class="container-fluid" >
        <div class="container" >
    
            <div class="headimage">
                <div class="blur">
                    <div class="option">
                        <div class="head" style="color: rgb(255, 255, 255);">
                            <h1>To Do List</h1>
                        </div>
                        <div class="row ">
                            <input type="text" class="col-6 " placeholder="ToDo*" id="inpt">
                            <button class="btn col-2 btn-primary change" id="add" onclick="add()" id="btncolor">Add</button>
                            <div class="col-3">
                                <button class=" btn btn-dark" id="change" onclick="optionshow()"><i
                                        class="fa-solid fa-filter"></i>
                                    All</button>
                                <ul id="option" class="optio">
                                    <li class="showall"><button class="btn" onclick="showall()"><i
                                                class="fa-solid fa-filter"></i>
                                            All</button></li>
                                    <li class="showactive"><button class="btn" onclick="active()"><i
                                                class="fa-solid fa-filter"></i>
                                            Active</button></li>
                                    <li class="showcomplt"><button class="btn" onclick="complt()"><i
                                                class="fa-solid fa-filter"></i>
                                            Completed</button></li>
                                </ul>
                            </div>
                        </div>
                        <div class="searchmenu">
                            <button class="btn searchicon" onclick="showsearchbar()" style="color: rgb(255, 255, 255);"><i
                                    class="fa-solid fa-magnifying-glass"></i></button>
                            <input type="text" id="searchbar" class="searchbar"
                                placeholder="Enter the element to be searched" onkeyup="search()">
                        </div>
                        <div class="todoadd" id="todoadd" style="background-color: rgb(245, 245, 245);">
    
                            <ul id="todolist">
    
                            </ul>
    
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- JavaScript Bundle with Popper -->
    <!-- <script src="js/todo.js"></script> -->
    <script>
        var searchitem = document.getElementById("searchbar")
        var inpt = document.getElementById("inpt");
        var list = [];
        var createcb = '';
        let arrdef = {};
        var deleteicon = "";
        var listadder = "";
        var listele = "";
        var todolist = document.getElementById("todolist");
        var activearr = "";
        var showallarr = "";
        var compltarr = '';
        var searcharr = '';
        var optionbutton = document.getElementById("change");
        var difopt = document.getElementById("option");
        var index = '';
        var showicon = document.getElementsByClassName("searchicon")
        var searchbar = document.getElementById("searchbar")
        var btn = document.getElementById("btncolor");
        // var actarr = '';
        var imparr = JSON.parse(localStorage.getItem("list")) || [];
        
        
        showall()
        
        
        function optionshow() {
            difopt.classList.toggle("showoption");
        }
        
        function showsearchbar() {
            searchbar.classList.toggle("showbar");
        }
        function add() {
            let expr = /^[1-9]/
            
            let checkedexpr = expr.test(inpt.value);


            if(inpt.value == "" || checkedexpr){
                console.log("Error");
            }
            else{

            createcb = document.createElement("input");
            createcb.type = "checkbox";
            createcb.id = "checbo";
            createcb.className = "checbo";
            
            deleteicon = document.createElement("i");
            deleteicon.className = "delete";
            
            arrdef = {
                name: inpt.value,
                check: createcb,
                status: false,
                delete: `<button id="del">
                    <i class="fa-solid fa-trash"></i>
                    </button>`,
                }

                imparr.push(arrdef);
                localStorage.setItem("list",JSON.stringify(imparr))
                         
                    
                 
                    listele = document.createElement('li');
                    arrout = document.createElement("span");
                    arrout.id = "arroutput";
                    arrout.className = "arroutput";
                    listadder = document.createElement('span');
                    listadder.id = "listadder";
                    
                    let index = imparr[imparr.length -1];
                    listadder.innerHTML = index.name;
                    deleteicon.innerHTML = index.delete;
                    
                    arrout.appendChild(createcb);
                    arrout.appendChild(listadder);
                    arrout.appendChild(deleteicon);
                    listele.append(arrout);
                    todolist.appendChild(listele);
                    
                    let remove = document.getElementsByClassName('delete');
                    for (let i = 0; i < remove.length; i++) {
                        remove[i].onclick = function () {
                            var div = this.parentElement;
                            div.style.display = "none";
                            imparr.splice(i, 1);
                            localStorage.setItem("list",JSON.stringify(imparr))
                        };
                    }
                    
                    
                }
                var checkboxchange = document.getElementsByClassName('checbo')
        for (let i = 0; i < checkboxchange.length; i++) {
            checkboxchange[i].addEventListener("click", () => {
                if (imparr[i].status) {
                    imparr[i].status = false;
                    localStorage.setItem("list",JSON.stringify(imparr));
            
                } else {
                    imparr[i].status = true;
                    localStorage.setItem("list",JSON.stringify(imparr));
                    
                }
            })
        }
        }
        function search(){
            while (todolist.hasChildNodes()) {
                todolist.removeChild(todolist.firstChild)
            }
            var searchit = searchitem.value;
            // console.log(searchit);
            searcharr = imparr.filter((item)=> item.name == searchit);
         
            
           
            if (searcharr.length != 0){
                for (let i=0;i<searcharr.length;i++){
                    createcb = document.createElement("input");
                    createcb.type = "checkbox";
                    createcb.id = "checbo";
                    createcb.className = "checbo";
                    
                    deleteicon = document.createElement("i");
                    deleteicon.className = "delete";
                    
                    listele = document.createElement('li');
                    arrout = document.createElement("span");
                    arrout.id = "arroutput";
                arrout.className = "arroutput";

                listadder = document.createElement('span');
                listadder.id = "listadder";
                
                let index = searcharr[i];
                listadder.innerHTML = index.name;
                deleteicon.innerHTML = index.delete;
                
                
                if (index.check.checked) {
                    
                    createcb.checked = true;
                    
                }
                else {
                    createcb.checked = false;
                    
                }
               
                arrout.appendChild(createcb);
                arrout.appendChild(listadder);
                arrout.appendChild(deleteicon);
                listele.append(arrout);
                todolist.appendChild(listele);
            }
        }
        else{
            
            todolist.innerHTML="Element you are searching is not available";
            // todolist.classList="nodata";
        }
    }
    
    
    function active() {
        optionbutton.innerHTML = '<i class="fa-solid fa-filter"></i>' + "Active";
        
        activearr = imparr.filter((list) =>
        list.status == false
        )
        // console.log(activearr)
        
        
        while (todolist.hasChildNodes()) {
            todolist.removeChild(todolist.firstChild)
        }
        
        for (let i = 0; i < activearr.length; i++) {
            
            
                createcb = document.createElement("input");
                createcb.type = "checkbox";
                createcb.id = "checbo";
                createcb.className = "checbo";

                deleteicon = document.createElement("i");
                deleteicon.className = "delete";


                listele = document.createElement('li');
                arrout = document.createElement("span");
                arrout.id = "arroutput";
                arrout.className = "arroutput";
                
                listadder = document.createElement('span');
                listadder.id = "listadder";
                index = activearr[i];
                listadder.innerHTML = index.name;
                deleteicon.innerHTML = index.delete;

                arrout.appendChild(createcb);
                arrout.appendChild(listadder);
                arrout.appendChild(deleteicon);
                listele.append(arrout);
                todolist.appendChild(listele);

                let remove = document.getElementsByClassName('delete');
                for (let i = 0; i < remove.length; i++) {
                    remove[i].onclick = function () {
                        var div = this.parentElement;
                        div.style.display = "none";
                        JSON.parse(localStorage.getItem("list"))
                        imparr.splice(i, 1);
                        localStorage.setItem("list",JSON.stringify(imparr))
                    };
                }
            }
            var checkboxchange = document.getElementsByClassName('checbo')
            for (let i = 0; i < checkboxchange.length; i++) {
                checkboxchange[i].addEventListener("click", () => {
                    if (imparr[i].status) {
                        imparr[i].status = false;
                        localStorage.setItem("list",JSON.stringify(imparr));
                        console.log("heloo");
                    } else {
                        imparr[i].status = true;
                        localStorage.setItem("list",JSON.stringify(imparr));
                        // console.log("what");
                    }
                })
            }

        }
        function showall() {
            optionbutton.innerHTML = '<i class="fa-solid fa-filter"></i>' + "All";
            showallarr = imparr;
            showicon.classList = "showicon";
            while (todolist.hasChildNodes()) {
                todolist.removeChild(todolist.firstChild)
            }
            for (let i = 0; i < showallarr.length; i++) {
                createcb = document.createElement("input");
                createcb.type = "checkbox";
                createcb.id = "checbo";
                createcb.className = "checbo";

                deleteicon = document.createElement("i");
                deleteicon.className = "delete";

                listele = document.createElement('li');
                arrout = document.createElement("span");
                arrout.id = "arroutput";
                arrout.className = "arroutput";

                listadder = document.createElement('span');
                listadder.id = "listadder";

                let index = showallarr[i];
                listadder.innerHTML = index.name;
                deleteicon.innerHTML = index.delete;
                // console.log(showallarr);

                if (index.status) {
                    console.log("hello")
                    createcb.checked = true;
                }
                else {
                    createcb.checked = false;

                }
                // console.log(showallarr[i]);
                arrout.appendChild(createcb);
                arrout.appendChild(listadder);
                arrout.appendChild(deleteicon);
                listele.append(arrout);
                todolist.appendChild(listele);

                let remove = document.getElementsByClassName('delete');
                for (let i = 0; i < remove.length; i++) {
                    remove[i].onclick = function () {
                        var div = this.parentElement;
                        div.style.display = "none";
                        JSON.parse(localStorage.getItem("list"))
                        imparr.splice(i, 1);
                            localStorage.setItem("list",JSON.stringify(imparr))
                    };
                }
            }
            var checkboxchange = document.getElementsByClassName('checbo')
            for (let i = 0; i < checkboxchange.length; i++) {
                checkboxchange[i].addEventListener("click", () => {
                    if (imparr[i].status) {
                        imparr[i].status = false;
                        localStorage.setItem("list",JSON.stringify(imparr));
                
                    } else {
                        imparr[i].status = true;
                        localStorage.setItem("list",JSON.stringify(imparr));
                        
                    }
                })
            }
            // list=showallarr;
        }
        function complt() {
            optionbutton.innerHTML = '<i class="fa-solid fa-filter"></i>' + "Completed";
            while (todolist.hasChildNodes()) {
                todolist.removeChild(todolist.firstChild)
            }

            compltarr = imparr.filter((item) => item.status == true)

            for (let i = 0; i < compltarr.length; i++) {

                createcb = document.createElement("input");
                createcb.type = "checkbox";
                createcb.checked = "true";
                createcb.id = "checbo";
                createcb.className = "checbo";
                deleteicon = document.createElement("i");
                deleteicon.className = "delete";



                listele = document.createElement('li');
                arrout = document.createElement("span");
                arrout.id = "arroutput";
                arrout.className = "arroutput";

                listadder = document.createElement('span');
                listadder.id = "listadder";
                let index = compltarr[i];
                listadder.innerHTML = index.name;
                deleteicon.innerHTML = index.delete;

                arrout.appendChild(createcb);
                arrout.appendChild(listadder);
                arrout.appendChild(deleteicon);
                listele.append(arrout);
                todolist.appendChild(listele);

                let remove = document.getElementsByClassName('delete');
                for (let i = 0; i < remove.length; i++) {
                    remove[i].onclick = function () {
                        var div = this.parentElement;
                        div.style.display = "none";
                        JSON.parse(localStorage.getItem("list"))
                        imparr.splice(i, 1);
                        localStorage.setItem("list",JSON.stringify(imparr))
                    };
                }
            }
            var checkboxchange = document.getElementsByClassName('checbo')
            for (let i = 0; i < checkboxchange.length; i++) {
                checkboxchange[i].addEventListener("click", () => {
                    if (imparr[i].status) {
                        imparr[i].status = false;
                        localStorage.setItem("todo",JSON.stringify(imparr));
                        console.log("heloo");
                    } else {
                        imparr[i].status = true;
                        localStorage.setItem("todo",JSON.stringify(imparr));
                        // console.log("what");
                    }
                })
            }
        }

    </script>
    <!-- <script src="js/todo1.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
        crossorigin="anonymous"></script>
</body>

</html> 